

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Running and integration &mdash; VVV 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="VVV 0.1 documentation" href="index.html" />
    <link rel="next" title="Validators and linters" href="validators.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="validators.html" title="Validators and linters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">VVV 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Running and integration</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#automatically-installed-files">Automatically installed files</a></li>
<li><a class="reference internal" href="#running-by-hand">Running by hand</a></li>
<li><a class="reference internal" href="#command-line-options">Command line options</a><ul>
<li><a class="reference internal" href="#important-command-line-options">Important command line options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integrating-with-git">Integrating with Git</a><ul>
<li><a class="reference internal" href="#local-repository">Local repository</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integration-with-subversion">Integration with Subversion</a><ul>
<li><a class="reference internal" href="#local-hook">Local hook</a></li>
<li><a class="reference internal" href="#server-side-hook">Server-side hook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integrating-with-travis-ci">Integrating with Travis CI</a></li>
<li><a class="reference internal" href="#integration-with-buildout-plone-zope">Integration with buildout / Plone / Zope</a><ul>
<li><a class="reference internal" href="#add-vvv-to-buildout">Add VVV to buildout</a></li>
<li><a class="reference internal" href="#add-pylint-to-buildout">Add pylint to buildout</a></li>
<li><a class="reference internal" href="#automatically-install-git-pre-commit-hooks">Automatically install git pre-commit hooks</a></li>
<li><a class="reference internal" href="#add-validation-options-yaml-configuration">Add validation-options.yaml configuration</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="previous chapter">Configuration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="validators.html"
                        title="next chapter">Validators and linters</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/integration.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="running-and-integration">
<h1>Running and integration<a class="headerlink" href="#running-and-integration" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#automatically-installed-files" id="id3">Automatically installed files</a></li>
<li><a class="reference internal" href="#running-by-hand" id="id4">Running by hand</a></li>
<li><a class="reference internal" href="#command-line-options" id="id5">Command line options</a><ul>
<li><a class="reference internal" href="#important-command-line-options" id="id6">Important command line options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integrating-with-git" id="id7">Integrating with Git</a><ul>
<li><a class="reference internal" href="#local-repository" id="id8">Local repository</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integration-with-subversion" id="id9">Integration with Subversion</a><ul>
<li><a class="reference internal" href="#local-hook" id="id10">Local hook</a></li>
<li><a class="reference internal" href="#server-side-hook" id="id11">Server-side hook</a></li>
</ul>
</li>
<li><a class="reference internal" href="#integrating-with-travis-ci" id="id12">Integrating with Travis CI</a></li>
<li><a class="reference internal" href="#integration-with-buildout-plone-zope" id="id13">Integration with buildout / Plone / Zope</a><ul>
<li><a class="reference internal" href="#add-vvv-to-buildout" id="id14">Add VVV to buildout</a></li>
<li><a class="reference internal" href="#add-pylint-to-buildout" id="id15">Add pylint to buildout</a></li>
<li><a class="reference internal" href="#automatically-install-git-pre-commit-hooks" id="id16">Automatically install git pre-commit hooks</a></li>
<li><a class="reference internal" href="#add-validation-options-yaml-configuration" id="id17">Add validation-options.yaml configuration</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>VVV will run and try to download, detects validators by filetype
in your source code repository and will try to download
needed validators automatically if they are not installed.
Installation is on-demand - if your project does not
contain PHP files no PHP validator will be installed.</p>
<p>In the case validators cannot be automatically installed due to system
dependencies (e.g. Java) you&#8217;ll get an error message
with a link to friendly installation instructions for a specific validator.</p>
</div>
<div class="section" id="automatically-installed-files">
<h2><a class="toc-backref" href="#id3">Automatically installed files</a><a class="headerlink" href="#automatically-installed-files" title="Permalink to this headline">¶</a></h2>
<p>By default, <a class="reference internal" href="installation.html"><em>VVV keeps automatically downloaded</em></a>
software in hidden <tt class="docutils literal"><span class="pre">.vvv</span></tt> folder. You can override
the folder location with a command line switch.</p>
<p>Also use <tt class="docutils literal"><span class="pre">--reinstall</span></tt> option as described below
to purge and reinstall files in this folder if needed.</p>
</div>
<div class="section" id="running-by-hand">
<h2><a class="toc-backref" href="#id4">Running by hand</a><a class="headerlink" href="#running-by-hand" title="Permalink to this headline">¶</a></h2>
<p>Here are instructions how to execute VVV in your
project folder manually.</p>
<p>Go to your source folder:</p>
<div class="highlight-python"><pre>cd ~/mycodeproject</pre>
</div>
<p>Execute VVV command from <a class="reference internal" href="installation.html"><em>your virtualenv installation</em></a>:</p>
<div class="highlight-python"><pre>~/vvv-venv/bin/vvv .</pre>
</div>
<p>That&#8217;s it, assuming the sane defaults work for you! VVV will be run against
all source files and it will reports errors against <a class="reference internal" href="configuration.html"><em>the currently
configured policy</em></a>.</p>
<p>You can also run against single files:</p>
<blockquote>
<div>vvv setup.py
vvv subfolder/main.py</div></blockquote>
<p>You can also execute vvv in any project subfolder and
vvv will pick the config files from any of the parent folders:</p>
<div class="highlight-python"><pre>cd subfolder
vvv main.py # Scan one file in subfolder
vvv . # Scan all files in the subfolder</pre>
</div>
</div>
<div class="section" id="command-line-options">
<h2><a class="toc-backref" href="#id5">Command line options</a><a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h2>
<p>Please use <tt class="docutils literal"><span class="pre">--help</span></tt> switch to see up-to-date command line help:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vvv</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<div class="section" id="important-command-line-options">
<h3><a class="toc-backref" href="#id6">Important command line options</a><a class="headerlink" href="#important-command-line-options" title="Permalink to this headline">¶</a></h3>
<p>Reinstall - download and reinstall all automatically
installed software in the case you had to abort the previous run
and incomplete files</p>
<p>Verbose - output a lot of troubleshooting information:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vvv</span> <span class="o">-</span><span class="n">v</span>
</pre></div>
</div>
<p>Reinstall - reinstall all automatically downloaded files in <tt class="docutils literal"><span class="pre">.vvv</span></tt> folder:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">vvv</span> <span class="o">--</span><span class="n">reinstall</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="integrating-with-git">
<h2><a class="toc-backref" href="#id7">Integrating with Git</a><a class="headerlink" href="#integrating-with-git" title="Permalink to this headline">¶</a></h2>
<div class="section" id="local-repository">
<h3><a class="toc-backref" href="#id8">Local repository</a><a class="headerlink" href="#local-repository" title="Permalink to this headline">¶</a></h3>
<p>Here are instructions how to set-up pre-commit hook with Git.
This prevents you to commit files violating policy.</p>
<p>If you have <a class="reference internal" href="installation.html"><em>a local installation using virtualenv</em></a>:</p>
<div class="highlight-python"><pre># Activate the virtualenv
source ~/vvv-venv/bin/activate

# Run pre-commit hook installation
vvv-install-git-pre-commit-hook</pre>
</div>
<p>After this git will run vvv for all local commits and aborts
the commit if the incoming files contain validation errors.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently vvv does not optimize and check only commited files.
This will be future feature.</p>
</div>
<p>You may want to skip precommit hook when you commit to Git when
you are intentionally committing bad code or you want to skip runnign validators:</p>
<div class="highlight-python"><pre>git commit --no-verify -m &quot;Those validator hooks prevent me committing crappy code, damn it!&quot;</pre>
</div>
<p>More info</p>
<ul class="simple">
<li><a class="reference external" href="http://book.git-scm.com/5_git_hooks.html">http://book.git-scm.com/5_git_hooks.html</a></li>
</ul>
</div>
</div>
<div class="section" id="integration-with-subversion">
<h2><a class="toc-backref" href="#id9">Integration with Subversion</a><a class="headerlink" href="#integration-with-subversion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="local-hook">
<h3><a class="toc-backref" href="#id10">Local hook</a><a class="headerlink" href="#local-hook" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">svn</span></tt> client-side command does not offer a way to execute hooks.
You can probably work around this with <tt class="docutils literal"><span class="pre">alias</span> <span class="pre">svn</span></tt>
but I have not yet figured out how.</p>
<ul class="simple">
<li><a class="reference external" href="http://svnbook.red-bean.com/en/1.7/svn.advanced.confarea.html">SVN client side options</a></li>
</ul>
</div>
<div class="section" id="server-side-hook">
<h3><a class="toc-backref" href="#id11">Server-side hook</a><a class="headerlink" href="#server-side-hook" title="Permalink to this headline">¶</a></h3>
<p>Subversion server allows you to install pre-commit hook which runs code
checks on the server when the client pushes in a potential commit.</p>
<p>TODO</p>
</div>
</div>
<div class="section" id="integrating-with-travis-ci">
<h2><a class="toc-backref" href="#id12">Integrating with Travis CI</a><a class="headerlink" href="#integrating-with-travis-ci" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://about.travis-ci.org/">Travis CI</a> is continuous integration and build service
which is free for open source projects to use.</p>
<p>VVV and Travic CI can be very easily integrated to your project:</p>
<ul class="simple">
<li>Travis CI will automatically run after you commit changes to your project on Github
(as the writing of thisGithub is the only supported VCS)</li>
<li>Travis CI will run VVV validation checks against your source code and reports possible violations.
Note that this does not prevent bad commits - you will just get notification afterwards
when bad stuff got in from the door already. But it&#8217;s still much better than running
validations, linting and tests by hand.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You don&#8217;t need to install any software or set-up any infrastructure. Travis CI
is provided free software-as-a-service for open source projects and all you
need to do this to register in Travis CI and drop one file in your
public source code repository.</p>
</div>
<p>All you need to do is to</p>
<ul class="simple">
<li>Login to <a class="reference external" href="http://travis-ci.org/">travis-ci.org</a> using your Github credentials</li>
<li>Turn on Travis for your repository - Travis will automatically list all your Github projects</li>
<li>Then visit the GitHub service hooks page for that project and paste your GitHub username and
Travis token into the settings for the Travis service if it is not already pre-filled.
(should not be needed unless your repo belongs to Github organization)</li>
<li>Drop <tt class="docutils literal"><span class="pre">.travis.yml</span></tt> having the option to run VVV in your repository root (example below)</li>
<li>Drop <tt class="docutils literal"><span class="pre">validation-options.yaml</span></tt> and <tt class="docutils literal"><span class="pre">validation-files.yaml</span></tt> policies in your repository root (optional, but you most likely want to tune validation error levels)</li>
<li>You can also <a class="reference external" href="http://about.travis-ci.org/docs/user/status-images/">include automatically generated status image to your Github README</a></li>
<li>After you push in <tt class="docutils literal"><span class="pre">.travis.yml</span></tt> for the first time it will trigger the build which you can
see on <a class="reference external" href="http://travis-ci.org/">travis-ci.org</a> <em>My Repositories</em> tab. It should appear there in seconds.</li>
</ul>
<p>Example <tt class="docutils literal"><span class="pre">.travis.yaml</span></tt> using the latest VVV release from <a class="reference external" href="http://pypi.python.org">pypi.python.org</a>:</p>
<div class="highlight-python"><pre>language: python

python:
  - &quot;3.2&quot;

# command to install dependencies
# - because we validate ourselves this is special
install:
  - pip install vvv --use-mirrors

# command to run tests
script: vvv .</pre>
</div>
<p>Example <tt class="docutils literal"><span class="pre">.travis.yml</span></tt> using the latest <a class="reference external" href="https://github.com/miohtama/vvv">VVV trunk from Github</a>:</p>
<div class="highlight-python"><pre>language: python

python:
  - &quot;3.2&quot;

# command to install dependencies
# - because we validate ourselves this is special
install:
  - pip install git://github.com/miohtama/vvv.git

# command to run tests
script: vvv .</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Travis CI uses .yml extension, VVV uses .yaml extension. VVV wins.</p>
</div>
<p>More info</p>
<ul class="simple">
<li><a class="reference external" href="http://about.travis-ci.org/docs/user/getting-started/">http://about.travis-ci.org/docs/user/getting-started/</a></li>
<li><a class="reference external" href="http://about.travis-ci.org/docs/user/build-configuration/">http://about.travis-ci.org/docs/user/build-configuration/</a></li>
<li><a class="reference external" href="https://github.com/travis-ci/travis-lint">https://github.com/travis-ci/travis-lint</a></li>
</ul>
</div>
<div class="section" id="integration-with-buildout-plone-zope">
<h2><a class="toc-backref" href="#id13">Integration with buildout / Plone / Zope</a><a class="headerlink" href="#integration-with-buildout-plone-zope" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://plone.org">Plone CMS</a> community
uses <a class="reference external" href="http://www.buildout.org">buildout</a>
tool to automatically configure, compile, install, etc.
software.</p>
<p>Because buildout determines Python environment under
which <tt class="docutils literal"><span class="pre">pylint</span></tt> must be executed some special considerations
are needed.</p>
<div class="section" id="add-vvv-to-buildout">
<h3><a class="toc-backref" href="#id14">Add VVV to buildout</a><a class="headerlink" href="#add-vvv-to-buildout" title="Permalink to this headline">¶</a></h3>
<p>This will install VVV with buildout run. In <tt class="docutils literal"><span class="pre">buildout.cfg</span></tt>:</p>
<div class="highlight-python"><pre>parts =
  ...
  vvv

# Install VVV under Python 3&#x27;s virtualenv vvv-venv in buildout root
# If you get &quot;SyntaxError: invalid syntax&quot; make sure your operating system&#x27;s virtualenv command is up-to-date
# for Python 3
[vvv]
recipe = plone.recipe.command
stop-on-error = true
location = ${buildout:directory}/vvv-venv
update-command = true
command = wget --no-check-certificate &quot;https://raw.github.com/pypa/virtualenv/master/virtualenv.py&quot; &amp;&amp; python3 virtualenv.py -p python3 ${buildout:directory}/vvv-venv &amp;&amp; source vvv-venv/bin/activate &amp;&amp; pip install vvv</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This assumes your operating system is using <strong>python3</strong> command. You can perfectly fine use commands <strong>python3.2</strong> or <strong>python3.1</strong> too.</p>
</div>
</div>
<div class="section" id="add-pylint-to-buildout">
<h3><a class="toc-backref" href="#id15">Add pylint to buildout</a><a class="headerlink" href="#add-pylint-to-buildout" title="Permalink to this headline">¶</a></h3>
<p>First you need to install <tt class="docutils literal"><span class="pre">pylint</span></tt> using buildout. In your <tt class="docutils literal"><span class="pre">buildout.cfg</span></tt> add:</p>
<div class="highlight-python"><pre>parts =
  pylint
  ...

# Install pylint command needed for VVV package validator
[pylint]
recipe = zc.recipe.egg
eggs =
    ${instance:eggs}
    pylint
entry-points = pylint=pylint.lint:Run
arguments = sys.argv[1:]</pre>
</div>
</div>
<div class="section" id="automatically-install-git-pre-commit-hooks">
<h3><a class="toc-backref" href="#id16">Automatically install git pre-commit hooks</a><a class="headerlink" href="#automatically-install-git-pre-commit-hooks" title="Permalink to this headline">¶</a></h3>
<p>You are probably checking out and managing source code with
<a class="reference external" href="http://pypi.python.org/pypi/mr.developer/">Mr. Developer</a>
and buildout.</p>
<p>The following snippet forces VVV pre-commit hook on checked out
Git repositories. Never commit bad code anymore!</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>precommit-hooks</strong> must come after <strong>vvv</strong> in buildout <strong>parts</strong> order.</p>
</div>
<p>Exampe <tt class="docutils literal"><span class="pre">buildout.cfg</span></tt> code:</p>
<div class="highlight-python"><pre>parts =
  vvv
  precommit-hooks
  ...

# Install git repository precommit hooks.
# Run this command against every git repository checked out by Mr. Developer
[precommit-hooks]
recipe = plone.recipe.command
stop-on-error = true
command = ${buildout:directory}/vvv-venv/bin/vvv-install-git-pre-commit-hook ${buildout:directory}/src/YOURREPO</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can use UNIX &amp;&amp; operator to run multiple commands in one line in <strong>plone.recipe.command</strong>.</p>
</div>
</div>
<div class="section" id="add-validation-options-yaml-configuration">
<h3><a class="toc-backref" href="#id17">Add validation-options.yaml configuration</a><a class="headerlink" href="#add-validation-options-yaml-configuration" title="Permalink to this headline">¶</a></h3>
<p>For example configuration files to be dropped
in your project root, please see <a class="reference external" href="https://github.com/miohtama/sane_plone_addon_template/tree/master/youraddon">youraddon Plone add-on template package on Github</a>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="validators.html" title="Validators and linters"
             >next</a> |</li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >previous</a> |</li>
        <li><a href="index.html">VVV 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Mikko Ohtamaa.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>